<!DOCTYPE html>
<html>
<head>
  <title>Bridge t3rn UI</title>
  <script src="https://cdn.jsdelivr.net/npm/ethers@5.7.2/dist/ethers.umd.min.js"></script>
  <style>
    body { font-family: sans-serif; max-width: 600px; margin: 40px auto; }
    input, button { padding: 10px; margin: 5px 0; width: 100%; }
    button { background: #4CAF50; color: white; border: none; cursor: pointer; }
  </style>
</head>
<body>
  <h2>Bridge ETH to Base Sepolia</h2>
  <label>Private Key:</label>
  <input type="password" id="privateKey" placeholder="0x. . ." />

  <label>label To Chain ID:</label>
  <input> type="number" id="toChainId" placeholder="84532" value="84532" />

  <label>Amount (ETH):</label>
  <input type="text" id="amount" placeholder="0.01" />

  <label>Recipient Address:</label>
  <input type="text" id="recipient" placeholder="0x..." />

  <button onclick="bridge()">Bridge Now</button>

  <p id="status"></p>

  <script>
    const proxyAddress = "0xb6Def636914Ae60173d9007E732684a9eEDEF26E"; // Ganti dengan alamat proxy
    const rpcUrl = "https://sepolia.optimism.io" 
    const abi = [
      // Ganti ini dengan ABI asli dari implementation contract
      {
        "inputs": [
          { "internalType": "uint256", "name": "toChainId", "type": "uint256" },
          { "internalType": "uint256", "name": "amount", "type": "uint256" },
          { "internalType": "address", "name": "recipient", "type": "address" }
        ],
        "name": "bridgeIn",
        "outputs": [],
        "stateMutability": "payable",
        "type": "function"
      }
    ];

    async function bridge() {
      const status = document.getElementById("status");
      const pk = document.getElementById("privateKey").value.trim();
      const toChainId = document.getElementById("toChainId").value;
      const amountEth = document.getElementById("amount").value;
      const recipient = document.getElementById("recipient").value;

      if (!pk  !amountEth || !recipient) {
        return status.innerText = "Semua kolom wajib diisi.";
      }

      try {
        const provider = new ethers.providers.JsonRpcProvider(rpcUrl);
        const wallet = new ethers.Wallet(pk, provider);

        const contract = new ethers.Contract(proxyAddress, abi, wallet);
        const amountWei = ethers.utils.parseEther(amountEth);

        status.innerText = "Mengirim transaksi...";
        const tx = await contract.bridgeIn(
          toChainId,
          amountWei,
          recipient,
          { value: amountWei }
        );

        status.innerText = "Tx dikirim: " + tx.hash;
        await tx.wait();
        status.innerText = "Transaksi berhasil dikonfirmasi!";
      } catch (err) {
        console.error(err);
        status.innerText = "Gagal: " + (err.message || err);
      }
    }
  </script>
</body>
</html>
