<!DOCTYPE html>
<html>
<head>
  <title>Bridge/Transfer DApp</title>
</head>
<body>
  <h2>Bridge/Transfer Token</h2>

  <input type="password" id="privateKey" placeholder="Private key (0x...)" /><br>
  <input type="text" id="contractAddress" placeholder="Bridge Contract Address (0x...)" /><br>
  <input type="text" id="toAddress" placeholder="To Address (0x...)" /><br>
  <input type="text" id="amount" placeholder="Amount" /><br>
  <input type="number" id="toChainId" placeholder="Target Chain ID (Optional)" /><br>
  <button onclick="bridgeTokens()">Send Bridge TX</button>

  <div id="log" style="background:#111;color:#0f0;padding:10px;height:300px;overflow:auto;margin-top:15px;font-family:monospace;"></div>

  <script src="https://cdn.jsdelivr.net/npm/ethers@5.7.2/dist/ethers.umd.min.js"></script>
  <script>
    const abi = [ 
      // Ganti ini dengan ABI dari kontrak bridge kamu
      {
        "inputs": [
          { "internalType": "address", "name": "to", "type": "address" },
          { "internalType": "uint256", "name": "amount", "type": "uint256" },
          { "internalType": "uint256", "name": "toChainId", "type": "uint256" }
        ],
        "name": "bridge",
        "outputs": [],
        "stateMutability": "nonpayable",
        "type": "function"
      }
    ];

    function log(msg) {
      const el = document.getElementById("log");
      el.textContent += [${new Date().toLocaleTimeString()}] ${msg}\n;
      el.scrollTop = el.scrollHeight;
    }

    async function bridgeTokens() {
      try {
        const privateKey = document.getElementById("privateKey").value.trim();
        const contractAddr = document.getElementById("contractAddress").value.trim();
        const to = document.getElementById("toAddress").value.trim();
        const amount = document.getElementById("amount").value.trim();
        const toChainId = document.getElementById("toChainId").value.trim();

        if (!privateKey  !to || !amount) {
          return log("Input tidak lengkap.");
        }

        const provider = new ethers.providers.JsonRpcProvider("https://sepolia.optimism.io"); // Ganti sesuai target jaringan
        const wallet = new ethers.Wallet(privateKey, provider);
        const contract = new ethers.Contract(contractAddr, abi, wallet);

        const tx = await contract.bridge(to, ethers.utils.parseEther(amount), parseInt(toChainId));
        log("Transaksi dikirim: " + tx.hash);
        const receipt = await tx.wait();
        log("Transaksi sukses: " + receipt.transactionHash);
      } catch (e) {
        log("Error: " + e.message);
      }
    }
  </script>
</body>
</html>
